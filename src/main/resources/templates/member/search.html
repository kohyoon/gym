<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>회원 조회</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-5">
  <h2 class="mb-4">회원 검색</h2>

  <form method="get" action="/member/search">
    <label for="searchType">검색 항목</label>
    <select name="searchType" id="searchType">
      <option value="all" th:selected="${searchType == 'all'}">전체</option>
      <option value="all" th:selected="${searchType == 'name'}">이름</option>
      <option value="all" th:selected="${searchType == 'email'}">이메일</option>
      <option value="all" th:selected="${searchType == 'phone'}">전화번호</option>
    </select>

    <input type="text" name="keyword" th:value="${keyword}" placeholder="검색어 입력" />
    <button type="submit">검색</button>
  </form>
  <br/>

  <table border="1" width="100%">
    <thead>
      <tr>
        <th>이름</th>
        <th>이메일</th>
        <th>전화번호</th>
        <th>선택</th>
      </tr>
    </thead>
    <tbody>
      <tr th:if="${#lists.isEmpty(members)}">
        <td colspan="4">검색 결과가 없습니다.</td>
      </tr>
      <tr th:each="member: ${members}">
        <td th:text="${member.name}"></td>
        <td th:text="${member.email}"></td>
        <td th:text="${member.phone}"></td>
        <td>
          <button type="button"
                  th:attr="data-id=${member.memberId}, data-name=${member.name}"
                  onclick="selectMemberFromAttr(this)">
            선택
          </button>
        </td>
      </tr>
    </tbody>


  </table>


</div>

<script>
  function selectMemberFromAttr(button) {
      const id = button.getAttribute("data-id");
      const name = button.getAttribute("data-name");

      opener.document.getElementById("memberId").value = id;
      opener.document.getElementById("memberName").value = name;
      window.close();
  }
</script>

</body>
</html>
